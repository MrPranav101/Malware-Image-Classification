from malimg import MaliMgClassification
import metrics
from models import MalwareModelsDispatcher

class Execute:
    def inceptionv3_model():
        pipe = MaliMgClassification()
        model_dispatcher = MalwareModelsDispatcher()

        model,modelname = model_dispatcher.inceptionv3_model()
        pipe.prepare_df()
        pipe.set_classifier(model)
        history, scores = pipe.train(n_splits=10, epochs=20,model_name=modelname)

    def resnet50():
        pipe = MaliMgClassification()
        model_dispatcher = MalwareModelsDispatcher()

        model,modelname = model_dispatcher.resnet50_model()
        pipe.prepare_df()
        pipe.set_classifier(model)
        history, scores = pipe.train(n_splits=10, epochs=20,model_name=modelname)

    def vgg16():
        pipe = MaliMgClassification()
        model_dispatcher = MalwareModelsDispatcher()

        model,modelname = model_dispatcher.vgg16_model()
        pipe.prepare_df()
        pipe.set_classifier(model)
        history, scores = pipe.train(n_splits=10, epochs=20,model_name=modelname)

if __name__ == '__main__':

    Execute.inceptionv3_model()
    Execute.resnet50()
    Execute.vgg16()

